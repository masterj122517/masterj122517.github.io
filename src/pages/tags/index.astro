---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog');
const allTags = allPosts.flatMap((post: any) => post.data.tags);
const uniqueTags = allTags.filter((tag: string, index: number) => allTags.indexOf(tag) === index);

const tagCounts: Record<string, number> = {};
allPosts.forEach((post: any) => {
  post.data.tags.forEach((tag: string) => {
    tagCounts[tag] = (tagCounts[tag] || 0) + 1;
  });
});
---

<BaseLayout title="All Tags - MasterJ's LostLand">
  <div class="pt-24 pb-12">
    <Header />
    
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-16">
      <h1 class="text-4xl md:text-5xl font-bold text-text mb-4">
        All Tags
      </h1>
      <p class="text-lg text-text-muted mb-12">
        Explore posts by topics that interest you.
      </p>
      
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        {uniqueTags.map((tag: any) => (
          <a
            href={`/tags/${tag}`}
            class="block p-6 bg-surface rounded-lg hover:bg-surface-hover transition-all duration-200 hover:transform hover:-translate-y-1"
          >
            <span class="text-xl font-semibold text-text mb-2 block">
              #{tag}
            </span>
            <span class="text-text-muted text-sm">
              {tagCounts[tag]} post{tagCounts[tag] !== 1 ? 's' : ''}
            </span>
          </a>
        ))}
      </div>
    </div>
    
    <Footer />
  </div>
</BaseLayout>
