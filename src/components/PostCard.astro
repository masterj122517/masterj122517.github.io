---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;

const { data } = post;
const { Content } = await post.render();

const categoryColors: Record<string, string> = {
  Tech: 'bg-indigo-500',
  Life: 'bg-blue-500',
  Tips: 'bg-emerald-500',
  Review: 'bg-purple-500',
  default: 'bg-gray-500',
};

const categoryColor = categoryColors[data.category] || categoryColors.default;

const formatDate = (date: Date) => {
  return new Date(date).toLocaleDateString('en-US', {
    month: 'short',
    day: 'numeric',
    year: 'numeric',
  });
};
---

<article class="break-inside-avoid mb-6">
  <a href={`/blog/${post.slug}`} class="block group">
    <div class="overflow-hidden rounded-lg bg-surface hover:bg-surface-hover transition-all duration-200 hover:transform hover:-translate-y-1">
      <div class="relative aspect-video overflow-hidden">
        <Image
          src={data.image}
          alt={data.title}
          width={600}
          height={400}
          loading="lazy"
          class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
        />
        <span class={`absolute top-3 left-3 px-2 py-1 text-xs font-medium text-white rounded ${categoryColor}`}>
          {data.category}
        </span>
      </div>
      
      <div class="p-4">
        <h3 class="text-lg font-semibold text-text mb-2 group-hover:text-accent transition-colors line-clamp-2">
          {data.title}
        </h3>
        
        <div class="flex items-center gap-3 text-sm text-text-muted mb-3">
          <time datetime={data.date.toISOString()}>
            {formatDate(data.date)}
          </time>
        </div>
        
        <p class="text-text-muted text-sm line-clamp-3">
          {data.description}
        </p>
        
        {data.tags.length > 0 && (
          <div class="flex flex-wrap gap-2 mt-4">
            {data.tags.map((tag: string) => (
              <a href={`/tags/${tag}`} class="text-xs text-text-muted hover:text-accent transition-colors">
                #{tag}
              </a>
            ))}
          </div>
        )}
      </div>
    </div>
  </a>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
